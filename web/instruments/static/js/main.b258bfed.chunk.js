(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){e.exports={Home:"Home_Home__1msaU",header:"Home_header__2oJBe"}},129:function(e,t,n){e.exports=n.p+"static/media/logo.60703f55.png"},130:function(e,t,n){e.exports={App:"App_App__3DchQ"}},133:function(e,t,n){e.exports=n(211)},138:function(e,t,n){},205:function(e,t,n){e.exports={TakeDropModal:"TakeDropModal_TakeDropModal__18Vb-"}},206:function(e,t,n){e.exports={Take:"Take_Take__w1XDx"}},207:function(e,t,n){e.exports={UserModal:"UserModal_UserModal__rCTYj"}},208:function(e,t,n){e.exports={InstrumentModal:"InstrumentModal_InstrumentModal__248NN"}},211:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(4),i=n.n(o),s=(n(138),n(139),n(10)),c=n(11),u=n(13),l=n(12),m=n(14),d=n(65),f=n(45),p=n(25),h=n(26),E=n(213),v=n(9),I=function e(){Object(s.a)(this,e)};I.APIURL="https://omaracuja-api.herokuapp.com/";var g=I,_=n(212),b=n(102),y=n.n(b),k=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),O=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={profile:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users/self"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.profile;e.setState({profile:r})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.state.profile;return e?a.a.createElement("div",{className:"Home"},a.a.createElement("h1",{className:y.a.header},"Accueil"),a.a.createElement("p",null,"Bienvenue"," ",a.a.createElement("span",{style:{fontWeight:"bold"}},e.username)),e.admin?a.a.createElement("p",null,"Niveau d'acc\xe8s : ",a.a.createElement("span",{style:{fontWeight:"bold"}},"Administrateur"," "),a.a.createElement(v.a,{type:"unlock"})):null,0===e.instruments.length?null:a.a.createElement("div",null,"Vous avez emprunt\xe9 les instruments suivants : ",a.a.createElement("div",{style:{fontWeight:"bold"}},e.instruments.map(function(e){return a.a.createElement("p",{key:e.name}," - ".concat(e.name))})))):a.a.createElement("div",null,a.a.createElement("h1",{className:y.a.header},"Accueil"),a.a.createElement(_.a,{indicator:k}))}}]),t}(a.a.Component),S=n(218),j=n(214),A=n(215),N=n(38),C=n(62),D=n.n(C),x=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),T=function(e){S.a[e]({message:"Wrong username or password !",description:""})},w=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).authenticate=function(e,t){var r=n.props.onAuthenticated,a={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({username:e,password:t}),mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"signin"),a).then(function(e){e.json().then(function(e){e.token?r(e.token):T("error")})}).catch(function(e){console.log(e)})},n.state={username:"",password:"",users:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users"),t).then(function(t){t.json().then(function(t){var n=t.users.map(function(e){return e.username});e.setState({users:n.sort(function(e,t){return e>t}),username:n[0]})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.username,r=t.password,o=t.users;return o?a.a.createElement("div",{className:D.a.Login},a.a.createElement("h1",{className:D.a.header},"Connexion"),a.a.createElement("form",{className:D.a.loginForm,onSubmit:function(t){t.preventDefault(),e.authenticate(n,r)}},a.a.createElement(j.a,{className:D.a.loginInput,defaultValue:n,style:{width:"100%"},onChange:function(t){e.setState({username:t})}},o.map(function(e){return a.a.createElement(j.a.Option,{key:e,value:e},e)})),a.a.createElement(A.a,{className:D.a.loginInput,addonBefore:"Password",value:r,onChange:function(t){return e.setState({password:t.target.value})},type:"password"}),a.a.createElement("br",null),a.a.createElement(N.a,{type:"primary",htmlType:"submit"},"Se connecter"))):a.a.createElement(_.a,{indicator:x})}}]),t}(a.a.Component),U=n(39),L=n.n(U),P=A.a.TextArea,R=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={hover:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.take,r=t.name,o=t.com,i=t.onSelect,s=this.state.hover;return a.a.createElement("div",{className:L.a.TakeDropItem,onMouseEnter:function(){return e.setState({hover:!0})},onMouseLeave:function(){return e.setState({hover:!1})}},a.a.createElement("div",null,a.a.createElement("span",{style:{fontSize:"1.5em",fontWeight:"bold"}},r)),o.length?a.a.createElement("div",{className:L.a.instrumentItemCom},a.a.createElement("div",{className:L.a.itemIcon},a.a.createElement(p.a,{icon:h.b})),a.a.createElement("div",{className:L.a.itemCom},a.a.createElement(P,{className:L.a.instrumentItemComTextArea,readOnly:!0,autosize:!0,value:o}))):null,s?a.a.createElement("div",{className:L.a.instrumentItemEditBtn},a.a.createElement("div",{className:L.a.instrumentItemEditBtn},a.a.createElement("div",null,a.a.createElement("span",{className:L.a.editBtnSpan},a.a.createElement(N.a,{type:"primary",onClick:i},a.a.createElement(v.a,{type:n?"vertical-align-top":"vertical-align-bottom"}),n?"Emprunter":"D\xe9poser"))))):null)}}]),t}(a.a.Component),J=n(216),M=(n(205),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={com:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.com,n=this.props,r=n.take,o=n.instrument,i=n.onValid,s=n.onCancel;return a.a.createElement(J.a,{title:r?"Emprunter l'instrument":"D\xe9poser l'instrument",visible:!0,onOk:function(){return i(t)},onCancel:function(){return s()},okText:"Confirmer",cancelText:"Annuler"},a.a.createElement("h3",null,o),a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"comInput"}," ","Commentaire",a.a.createElement(A.a.TextArea,{onChange:function(t){return e.setState({com:t.target.value})},id:"comInput",style:{resize:"none"},value:t,placeholder:"Commentaire (optionel)"}))))}}]),t}(a.a.Component)),B=function(){function e(t,n,r){Object(s.a)(this,e),this._id=t,this.username=n,this.admin=r}return Object(c.a)(e,[{key:"clone",value:function(){return e.fromJSON(this.toJSON())}},{key:"toJSON",value:function(){return{_id:this._id,username:this.username,admin:this.admin}}}],[{key:"fromJSON",value:function(t){return new e(t._id,t.username,t.admin)}}]),e}(),z=function(){function e(t,n,r,a){Object(s.a)(this,e),this._id=t,this.name=n,this.user=r,this.com=a}return Object(c.a)(e,[{key:"clone",value:function(){return e.fromJSON(this.toJSON())}},{key:"toJSON",value:function(){return{_id:this._id,name:this.name,user:this.user.toJSON(),com:this.com}}}],[{key:"fromJSON",value:function(t){return new e(t._id,t.name,t.user?B.fromJSON(t.user):null,t.com)}}]),e}(),K=(n(206),a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0})),V=function(e,t){S.a[e]({message:t,description:""})},F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onTake=function(e){var t=n.props.onExpiredAuth,r=n.state,a=r.instruments,o=r.profile,i=r.modalID,s=a.find(function(e){return e._id===i}),c=JSON.stringify({id:s._id,name:s.name,user:o._id,com:e}),u={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:c,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/update"),u).then(function(r){r.json().then(function(r){if(r.error)"notAuthenticated"===r.error&&t();else{var a=r.instruments;V("success","Instrument emprunt\xe9!"),n.setState(function(t){return{instruments:a.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),profile:Object.assign(t.profile,{instruments:t.profile.instruments.concat([{_id:s._id,name:s.name,com:e}])}),modalID:null}})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.state={instruments:null,profile:null,modalID:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.instruments,a=n.profile;e.setState({instruments:r,profile:a})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.instruments,r=t.profile,o=t.modalID;return r?a.a.createElement("div",{className:"Take"},o?a.a.createElement(M,{take:!0,instrument:n.find(function(e){return e._id===o}).name,onValid:function(t){return e.onTake(t)},onCancel:function(){return e.setState({modalID:null})}}):null,a.a.createElement("h1",{className:"header"},"Emprunter un instrument au nom de ".concat(r.username)),0===n.length?a.a.createElement("span",{style:{fontWeight:"bold"}},"Aucun instrument n'est disponible!"):a.a.createElement("div",null,a.a.createElement("div",{className:"intrumentList"},n.sort(function(e,t){return e.name>t.name}).map(function(t){return a.a.createElement(R,{key:t.name,take:!0,name:t.name,com:t.com,onSelect:function(){return e.setState({modalID:t._id})}})})))):a.a.createElement(_.a,{indicator:K})}}]),t}(a.a.Component),W=n(51),G=n.n(W),H=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),Q=function(e,t){S.a[e]({message:t,description:""})},Y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onDrop=function(e){var t=n.props.onExpiredAuth,r=n.state,a=r.instruments,o=r.modalID,i=a.find(function(e){return e._id===o}),s=JSON.stringify({id:i._id,name:i.name,user:null,com:e}),c={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:s,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/update"),c).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error&&t();else{var r=e.instruments;Q("success","Instrument depos\xe9!"),n.setState(function(e){return{instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),profile:Object.assign(e.profile,{instruments:e.profile.instruments.filter(function(e){return e._id!==o})}),modalID:null}})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.state={instruments:null,profile:null,modalID:null,filter:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.instruments,a=n.profile;e.setState({instruments:r,profile:a})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.instruments,r=t.profile,o=t.filter,i=t.modalID,s=n?n.filter(function(e){return r.instruments.findIndex(function(t){return t._id===e._id})>-1&&e.name.match(new RegExp(o,"gi"))}):null;return r?a.a.createElement("div",{className:G.a.Drop},i?a.a.createElement(M,{take:!1,instrument:n.find(function(e){return e._id===i}).name,onValid:function(t){return e.onDrop(t)},onCancel:function(){return e.setState({modalID:null})}}):null,a.a.createElement("h1",{className:G.a.header},"Instruments emprunt\xe9s par ".concat(r.username)),0===s.length?a.a.createElement("span",{style:{fontWeight:"bold",color:"white"}},"Vous n'\xeates en possession d'aucun instrument!"):a.a.createElement("div",null,a.a.createElement("div",{className:G.a.upList},a.a.createElement("div",{className:G.a.filters},a.a.createElement("h5",null,"Recherche"),a.a.createElement("p",null,a.a.createElement(A.a,{title:"Rechercher un instrument",placeholder:"Rechercher un instrument",value:o,onChange:function(t){return e.setState({filter:t.target.value.trimStart()})}})))),a.a.createElement("div",{className:G.a.intrumentList},s.sort(function(e,t){return e.name>t.name}).map(function(t){return a.a.createElement(R,{key:t.name,take:!1,name:t.name,com:t.com,onSelect:function(){return e.setState({modalID:t._id})}})})))):a.a.createElement("div",null,a.a.createElement("h1",{className:G.a.header},"Chargement"),a.a.createElement(_.a,{indicator:H}))}}]),t}(a.a.Component),X=n(219),Z=n(71),q=n.n(Z),$=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),ee=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={hover:!1,instruments:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.onExpiredAuth,r=t.userId,a={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/").concat(r),a).then(function(t){t.json().then(function(t){if(t.error)"notAuthenticated"===t.error&&n();else{var r=t.instruments;e.setState({instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.username>t.username})})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.username,r=t.admin,o=t.adminMode,i=t.onEdit,s=t.onDelete,c=this.state,u=c.hover,l=c.instruments;return a.a.createElement("div",{className:q.a.UserItem,onMouseEnter:function(){return e.setState({hover:!0})},onMouseLeave:function(){return e.setState({hover:!1})}},a.a.createElement("div",null,a.a.createElement("span",{style:{fontSize:"1.5em",fontWeight:"bold"}},n)),a.a.createElement("div",{className:q.a.userItemInfo},a.a.createElement("div",{className:q.a.userInstru},a.a.createElement("span",{style:{color:"brown"}},a.a.createElement(p.a,{icon:h.c}))," ",a.a.createElement("span",{style:{textDecoration:"underline"}},"Instruments:")," ",l?l.map(function(e){return a.a.createElement(X.a,{key:e.name},e.name)}):a.a.createElement(_.a,{indicator:$})),o?a.a.createElement("div",null,r?a.a.createElement("span",{style:{color:"green"}},a.a.createElement(p.a,{icon:h.e})):a.a.createElement("span",{style:{color:"red"}},a.a.createElement(p.a,{icon:h.d}))," ",a.a.createElement("span",{style:{textDecoration:"underline"}},"Niveau d'acc\xe8s:")," ",a.a.createElement("span",{style:{fontWeight:"bold"}},r?"Administrateur":"Membre")):null),u&&o?a.a.createElement("div",{className:q.a.userItemEditBtn},a.a.createElement("div",null,a.a.createElement(N.a,{type:"primary",onClick:i},a.a.createElement(v.a,{type:"edit"}),"Editer")," ",a.a.createElement(N.a,{type:"danger",onClick:s},a.a.createElement(v.a,{type:"delete"}),"Supprimer"))):null)}}]),t}(a.a.Component),te=n(220),ne=n(217),re=(n(207),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={username:e.user?e.user.username:"",admin:!!e.user&&e.user.admin},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"hasChanged",value:function(){var e=this.state,t=e.username,n=e.admin,r=this.props.user;return t!==r.username||n!==r.admin}},{key:"render",value:function(){var e=this,t=this.state,n=t.username,r=t.admin,o=this.props,i=o.user,s=o.onValid,c=o.onCancel,u=i&&!this.hasChanged()?"Pas de modification effectu\xe9e!":null,l=n.length>0?null:"Vous devez entrer un nom!";return a.a.createElement(J.a,{title:i?"Modification de membre":"Ajout de membre",visible:!0,onOk:function(){return s(new B(i?i._id:null,n.trimEnd(),r))},onCancel:function(){return c()},cancelText:"Annuler",okButtonProps:{disabled:l||u}},a.a.createElement("div",null,l?a.a.createElement(te.a,{message:l,type:"error"}):null,u?a.a.createElement(te.a,{message:u,type:"warning"}):null,a.a.createElement("label",{htmlFor:"nameInput"},"Nom"," ",a.a.createElement(A.a,{id:"nameInput",required:!0,value:n,placeholder:"Nom du membre",onChange:function(t){return e.setState({username:t.target.value.trimStart()})}})),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("label",{htmlFor:"adminInput"},"Admin"," ",a.a.createElement(ne.a,{id:"adminInput",checked:r,onChange:function(){e.setState({admin:!r})}}))))}}]),t}(a.a.Component));re.defaultProps={user:null};var ae=re,oe=n(63),ie=n.n(oe),se=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),ce=function(e,t){S.a[e]({message:t,description:""})},ue=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onEdit=function(e){var t=n.state.profile,r=e;r._id===t._id&&!1===r.admin&&(ce("warning","Vous ne pouvez pas modifier votre propre niveau d'acc\xe8s!"),r.admin=!0);var a=n.props.onExpiredAuth,o=JSON.stringify({id:r._id,username:r.username,admin:r.admin}),i={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:o,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users/update"),i).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error?a():"notAdmin"===e.error?n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}}):"duplicate"===e.error&&ce("error","Nom d\xe9j\xe0 utilis\xe9!");else{var t=e.users;ce("success","Membre mis \xe0 jour!"),n.setState({users:t.map(function(e){return B.fromJSON(e)}).sort(function(e,t){return e.username>t.username}),editingUserID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onAdd=function(e){var t=n.props.onExpiredAuth,r={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:JSON.stringify({username:e.username,admin:e.admin}),mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users/add"),r).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error?t():"notAdmin"===e.error?n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}}):"duplicate"===e.error&&ce("error","Nom d\xe9j\xe0 utilis\xe9!");else{var r=e.users;ce("success","Membre ajout\xe9!"),n.setState({users:r.map(function(e){return B.fromJSON(e)}).sort(function(e,t){return e.username>t.username}),editingUserID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onDelete=function(){var e=n.props.onExpiredAuth,t=n.state.deletingUserID,r={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:JSON.stringify({id:t}),mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users/delete"),r).then(function(t){t.json().then(function(t){if(t.error)"notAuthenticated"===t.error?e():"notAdmin"===t.error&&n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}});else{var r=t.users;ce("success","Membre supprim\xe9!"),n.setState({users:r.map(function(e){return B.fromJSON(e)}).sort(function(e,t){return e.username>t.username}),deletingUserID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.state={users:null,profile:null,editingUserID:null,deletingUserID:null,filter:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.users,a=n.profile;e.setState({users:r.map(function(e){return B.fromJSON(e)}).sort(function(e,t){return e.username>t.username}),profile:a})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,r=t.profile,o=t.editingUserID,i=t.deletingUserID,s=t.filter,c=this.props.onExpiredAuth,u=n?n.filter(function(e){return e.username.match(new RegExp(s,"gi"))}):null;return a.a.createElement("div",{className:ie.a.Users},a.a.createElement("h1",{className:ie.a.header},"Membres"),null===u?a.a.createElement(_.a,{indicator:se}):a.a.createElement("div",null,o?a.a.createElement(ae,{user:o&&o.length>-1?u.find(function(e){return e._id===o}):null,onValid:function(t){return o.length>-1?e.onEdit(t):e.onAdd(t)},onCancel:function(){return e.setState({editingUserID:null})}}):null,i?a.a.createElement(J.a,{title:"Confirmer la suppression de ce membre?",visible:!0,onOk:function(){return e.onDelete()},okType:"danger",cancelText:"Annuler",onCancel:function(){return e.setState({deletingUserID:null})}}):null,a.a.createElement("div",{className:ie.a.upList},r.admin?a.a.createElement(N.a,{type:"primary",style:{backgroundColor:"green",borderColor:"green"},onClick:function(){e.setState({editingUserID:-1})}},a.a.createElement(v.a,{type:"plus-circle"}),"Ajouter un membre"):null,a.a.createElement("div",{className:ie.a.filters},a.a.createElement("h5",null,"Recherche"),a.a.createElement("p",null,a.a.createElement(A.a,{title:"Rechercher un membre",placeholder:"Rechercher un membre",value:s,onChange:function(t){return e.setState({filter:t.target.value.trimStart()})}})))),a.a.createElement("div",{className:ie.a.userList},u.map(function(t){return a.a.createElement(ee,{key:t.username,userId:t._id,username:t.username,admin:t.admin,adminMode:r.admin,onExpiredAuth:c,onEdit:function(){e.setState({editingUserID:t._id})},onDelete:function(){t._id===r._id?ce("error","Vous ne pouvez pas vous supprimer vous m\xeame!"):e.setState({deletingUserID:t._id})}})}))))}}]),t}(a.a.Component),le=n(32),me=n.n(le),de=A.a.TextArea,fe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={hover:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.take,r=t.name,o=t.user,i=t.com,s=t.onEdit,c=t.onDelete,u=t.admin,l=t.onTakeDrop,m=this.state.hover;return a.a.createElement("div",{className:me.a.InstrumentItem,onMouseEnter:function(){return e.setState({hover:!0})},onMouseLeave:function(){return e.setState({hover:!1})}},a.a.createElement("div",null,a.a.createElement("span",{style:{fontSize:"1.5em",fontWeight:"bold"}},r)),a.a.createElement("div",{className:me.a.instrumentItemUser},a.a.createElement("span",null,o?a.a.createElement("p",null,a.a.createElement("span",{style:{color:"red"}},a.a.createElement(p.a,{icon:h.a}))," ","Emprunt\xe9 par"," ",a.a.createElement("span",{style:{fontSize:"1.1em",fontWeight:"bold"}},o)):a.a.createElement("p",null,a.a.createElement("span",{style:{color:"green"}},a.a.createElement(p.a,{icon:h.a}))," ","Disponible au"," ",a.a.createElement("span",{style:{fontSize:"1.1em",fontWeight:"bold"}},"stock / autre")))),i.length?a.a.createElement("div",{className:me.a.instrumentItemCom},a.a.createElement("div",{className:me.a.itemIcon},a.a.createElement(p.a,{icon:h.b})),a.a.createElement("div",{className:me.a.itemCom},a.a.createElement(de,{className:me.a.instrumentItemComTextArea,readOnly:!0,autosize:!0,value:i}))):null,m?a.a.createElement("div",{className:me.a.instrumentItemEditBtn},a.a.createElement("div",{className:me.a.instrumentItemEditBtn},a.a.createElement("div",null,a.a.createElement("span",{className:me.a.editBtnSpan},a.a.createElement(N.a,{type:"primary",onClick:l},a.a.createElement(v.a,{type:n?"vertical-align-top":"vertical-align-bottom"}),n?"Emprunter":"D\xe9poser au studio")),u?a.a.createElement("span",null,"- ",a.a.createElement("span",{className:me.a.editBtnSpan},a.a.createElement(N.a,{type:"primary",onClick:s},a.a.createElement(v.a,{type:"edit"}),"Editer")),a.a.createElement("span",{className:me.a.editBtnSpan},a.a.createElement(N.a,{type:"danger",onClick:c},a.a.createElement(v.a,{type:"delete"}),"Supprimer"))):null))):null)}}]),t}(a.a.Component);fe.defaultProps={user:null};var pe=fe,he=(n(208),j.a.Option),Ee=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),ve=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={name:e.instrument?e.instrument.name:"",user:e.instrument?e.instrument.user:null,com:e.instrument?e.instrument.com:"",users:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"users"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.users;r?e.setState({users:r.map(function(e){return B.fromJSON(e)})}):t()}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"hasChanged",value:function(){var e=this.state,t=e.name,n=e.user,r=e.com,a=this.props.instrument;return t!==a.name||n&&!a.user||!n&&a.user||n&&a.user&&n._id!==a.user._id||r!==a.com}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,r=t.user,o=t.com,i=t.users,s=this.props,c=s.instrument,u=s.onValid,l=s.onCancel,m=c&&!this.hasChanged()?"Pas de modification effectu\xe9e!":null,d=n.length>0?null:"Vous devez entrer un nom!";return a.a.createElement(J.a,{title:c?"Modification d'instrument":"Ajout d'instrument",visible:!0,onOk:function(){return u(new z(c?c._id:null,n.trimEnd(),r,o.trimEnd()))},onCancel:function(){return l()},cancelText:"Annuler",okButtonProps:{disabled:d||m}},null===i?a.a.createElement(_.a,{indicator:Ee}):a.a.createElement("div",null,d?a.a.createElement(te.a,{message:d,type:"error"}):null,m?a.a.createElement(te.a,{message:m,type:"warning"}):null,a.a.createElement("label",{htmlFor:"nameInput"}," ","Nom",a.a.createElement(A.a,{id:"nameInput",required:!0,value:n,placeholder:"Nom de l'instrument",onChange:function(t){return e.setState({name:t.target.value.trimStart()})}})),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("label",{htmlFor:"userInput"}," ","En possession de",a.a.createElement(j.a,{id:"userInput",defaultValue:r?r._id:"null",style:{width:"100%"},onChange:function(t){e.setState({user:"null"!==t?i.find(function(e){return e._id===t}):null})}},[a.a.createElement(he,{key:"null",value:"null"},"Stock/Autre")].concat(i.map(function(e){return a.a.createElement(he,{key:e,value:e._id},e.username)})))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("label",{htmlFor:"comInput"}," ","Commentaire",a.a.createElement(A.a.TextArea,{onChange:function(t){return e.setState({com:t.target.value.trimStart()})},id:"comInput",style:{resize:"none"},value:o,placeholder:"Commentaire (optionel)"}))))}}]),t}(a.a.Component);ve.defaultProps={instrument:null};var Ie=ve,ge=n(64),_e=n.n(ge),be=a.a.createElement(v.a,{type:"loading",style:{fontSize:24},spin:!0}),ye=function(e,t){S.a[e]({message:t,description:""})},ke=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onEdit=function(e){var t=n.props.onExpiredAuth,r=JSON.stringify({id:e._id,name:e.name,user:e.user?e.user._id:null,com:e.com}),a={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:r,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/update"),a).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error?t():"notAdmin"===e.error?n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}}):"duplicate"===e.error&&ye("error","Nom d\xe9j\xe0 utilis\xe9!");else{var r=e.instruments;ye("success","Instrument mis \xe0 jour!"),n.setState({instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),editingInstrumentID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onAdd=function(e){var t=n.props.onExpiredAuth,r={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:JSON.stringify({name:e.name,user:e.user?e.user._id:null,com:e.com}),mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/add"),r).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error?t():"notAdmin"===e.error?n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}}):"duplicate"===e.error&&ye("error","Nom d\xe9j\xe0 utilis\xe9!");else{var r=e.instruments;ye("success","Instrument ajout\xe9!"),n.setState({instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),editingInstrumentID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onDelete=function(){var e=n.props.onExpiredAuth,t=n.state.deletingInstrumentID,r={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:JSON.stringify({id:t}),mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/delete"),r).then(function(t){t.json().then(function(t){if(t.error)"notAuthenticated"===t.error?e():"notAdmin"===t.error&&n.setState(function(e){return{profile:Object.assign(e.profile,{admin:!1})}});else{var r=t.instruments;ye("success","Instrument supprim\xe9!"),n.setState({instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),deletingInstrumentID:null})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onTake=function(e){var t=n.props.onExpiredAuth,r=n.state,a=r.instruments,o=r.profile,i=r.takeDropInstrumentID,s=a.find(function(e){return e._id===i}),c=JSON.stringify({id:s._id,name:s.name,user:o._id,com:e}),u={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:c,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/update"),u).then(function(r){r.json().then(function(r){if(r.error)"notAuthenticated"===r.error&&t();else{var a=r.instruments;ye("success","Instrument emprunt\xe9!"),n.setState(function(t){return{instruments:a.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),profile:Object.assign(t.profile,{instruments:t.profile.instruments.concat([{_id:s._id,name:s.name,com:e}])}),takeDropInstrumentID:null}})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.onDrop=function(e){var t=n.props.onExpiredAuth,r=n.state,a=r.instruments,o=r.takeDropInstrumentID,i=a.find(function(e){return e._id===o}),s=JSON.stringify({id:i._id,name:i.name,user:null,com:e}),c={method:"POST",headers:{"x-access-token":g.TOKEN,"Content-type":"application/json"},body:s,mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments/update"),c).then(function(e){e.json().then(function(e){if(e.error)"notAuthenticated"===e.error&&t();else{var r=e.instruments;ye("success","Instrument depos\xe9!"),n.setState(function(e){return{instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),profile:Object.assign(e.profile,{instruments:e.profile.instruments.filter(function(e){return e._id!==o})}),takeDropInstrumentID:null}})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},n.filterAvailables=function(e){n.setState({filterAvailable:e,filterRent:!1})},n.filterRents=function(e){n.setState({filterAvailable:!1,filterRent:e})},n.state={instruments:null,profile:null,editingInstrumentID:null,deletingInstrumentID:null,takeDropInstrumentID:null,filter:"",filterAvailable:!1,filterRent:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=this.props.onExpiredAuth,n={method:"GET",headers:{"x-access-token":g.TOKEN},mode:"cors",cache:"default"};window.fetch("".concat(g.APIURL,"instruments"),n).then(function(n){n.json().then(function(n){if(n.error)"notAuthenticated"===n.error&&t();else{var r=n.instruments,a=n.profile;e.setState({instruments:r.map(function(e){return z.fromJSON(e)}).sort(function(e,t){return e.name>t.name}),profile:a})}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.instruments,r=t.profile,o=t.editingInstrumentID,i=t.deletingInstrumentID,s=t.takeDropInstrumentID,c=t.filter,u=t.filterAvailable,l=t.filterRent,m=this.props.onExpiredAuth,d=null;n&&(d=n.filter(function(e){return e.name.match(new RegExp(c,"gi"))})),n&&u?d=d.filter(function(e){return null===e.user}):n&&l&&(d=d.filter(function(e){return null!==e.user}));var f=s&&(null===n.find(function(e){return e._id===s}).user||n.find(function(e){return e._id===s}).user._id===r._id);return a.a.createElement("div",{className:_e.a.Instruments},a.a.createElement("h1",{className:_e.a.header},"Instruments"),null===n?a.a.createElement(_.a,{indicator:be}):a.a.createElement("div",null,o?a.a.createElement(Ie,{instrument:o&&o.length>-1?n.find(function(e){return e._id===o}):null,onValid:function(t){return o.length>-1?e.onEdit(t):e.onAdd(t)},onCancel:function(){return e.setState({editingInstrumentID:null})},onExpiredAuth:function(){return m()}}):null,i?a.a.createElement(J.a,{title:"Confirmer la suppression de cet instrument?",visible:!0,onOk:function(){return e.onDelete()},okType:"danger",cancelText:"Annuler",onCancel:function(){return e.setState({deletingInstrumentID:null})}}):null,s?a.a.createElement(M,{take:f,instrument:n.find(function(e){return e._id===s}).name,onValid:function(t){return f?e.onTake(t):e.onDrop(t)},onCancel:function(){return e.setState({takeDropInstrumentID:null})}}):null,a.a.createElement("div",{className:_e.a.upList},r.admin?a.a.createElement("div",null,a.a.createElement(N.a,{type:"primary",style:{backgroundColor:"green",borderColor:"green"},onClick:function(){e.setState({editingInstrumentID:-1})}},a.a.createElement(v.a,{type:"plus-circle"}),"Ajouter un instrument"),a.a.createElement("br",null),a.a.createElement("br",null)):null,a.a.createElement("div",{className:_e.a.filters},a.a.createElement("h5",null,"Recherche"),a.a.createElement("p",null,a.a.createElement(A.a,{title:"Rechercher un instrument",placeholder:"Rechercher un instrument",value:c,onChange:function(t){return e.setState({filter:t.target.value.trimStart()})}})),a.a.createElement("p",null,a.a.createElement(ne.a,{onChange:function(t){return e.filterAvailables(t.target.checked)},checked:u},a.a.createElement("span",{style:{color:"green"}},a.a.createElement(p.a,{icon:h.a}))," Disponibles")),a.a.createElement("p",null,a.a.createElement(ne.a,{onChange:function(t){return e.filterRents(t.target.checked)},checked:l},a.a.createElement("span",{style:{color:"red"}},a.a.createElement(p.a,{icon:h.a}))," Emprunt\xe9s")))),a.a.createElement("div",{className:_e.a.intrumentList},d.map(function(t){return a.a.createElement(pe,{key:t.name,take:null===t.user||t.user._id!==r._id,name:t.name,user:t.user?t.user.username:null,com:t.com,admin:r.admin,onEdit:function(){return e.setState({editingInstrumentID:t._id})},onDelete:function(){return e.setState({deletingInstrumentID:t._id})},onTakeDrop:function(){return e.setState({takeDropInstrumentID:t._id})}})}))))}}]),t}(a.a.Component),Oe=function e(){Object(s.a)(this,e)};Oe.getCookie=function(e){for(var t="".concat(e,"="),n=decodeURIComponent(document.cookie).split(";"),r=0;r<n.length;r+=1){for(var a=n[r];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""},Oe.setCookie=function(e,t,n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var a="expires=".concat(r.toUTCString());document.cookie="".concat(e,"=").concat(t,";").concat(a,";path=/")},Oe.deleteCookie=function(e){document.cookie="".concat(e,"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT")};var Se=Oe,je=n(129),Ae=n.n(je),Ne=n(130),Ce=n.n(Ne),De=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onAuthenticated=function(e){g.TOKEN=e,Se.setCookie("token",e,365),n.setState({authenticated:!0})},n.onExpiredAuth=function(){Se.deleteCookie("token"),n.setState({authenticated:!1})},g.TOKEN=Se.getCookie("token"),n.state={authenticated:g.TOKEN.length>0},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.authenticated;return a.a.createElement(d.a,{basename:"/autres/build"},a.a.createElement("div",{className:Ce.a.App},a.a.createElement("img",{width:"200px",src:Ae.a,alt:"logo"}),a.a.createElement("h3",null,"Page de gestion des instruments"),t?a.a.createElement("div",null,a.a.createElement(E.b,{defaultSelectedKeys:[window.location.pathname],mode:"horizontal"},a.a.createElement(E.b.Item,{key:"/"},a.a.createElement(d.b,{to:"/"},a.a.createElement(v.a,{type:"home"}),"Accueil")),a.a.createElement(E.b.Item,{key:"/instruments"},a.a.createElement(d.b,{to:"/instruments"},a.a.createElement(v.a,{type:"notification"}),"Liste des instruments")),a.a.createElement(E.b.Item,{key:"/users"},a.a.createElement(d.b,{to:"/users"},a.a.createElement(v.a,{type:"contacts"}),"Liste des membres")),a.a.createElement(E.b.Item,{key:"/drop"},a.a.createElement(d.b,{to:"/drop"},a.a.createElement(p.a,{icon:h.c})," ","Mes instruments")),a.a.createElement(E.b.Item,{key:"logout",onClick:function(){return e.onExpiredAuth()}},a.a.createElement(v.a,{type:"logout"}),"Se d\xe9connecter")),a.a.createElement(f.d,null,a.a.createElement(f.b,{path:"/",exact:!0,render:function(){return a.a.createElement(O,{onExpiredAuth:e.onExpiredAuth})}}),a.a.createElement(f.b,{path:"/take/",render:function(){return a.a.createElement(F,{onExpiredAuth:e.onExpiredAuth})}}),a.a.createElement(f.b,{path:"/drop/",render:function(){return a.a.createElement(Y,{onExpiredAuth:e.onExpiredAuth})}}),a.a.createElement(f.b,{path:"/users/",render:function(){return a.a.createElement(ue,{onExpiredAuth:e.onExpiredAuth})}}),a.a.createElement(f.b,{path:"/instruments/",render:function(){return a.a.createElement(ke,{onExpiredAuth:e.onExpiredAuth})}}),a.a.createElement(f.b,{path:"/*",render:function(){return a.a.createElement(f.a,{to:"/"})}}))):a.a.createElement(w,{onAuthenticated:this.onAuthenticated})))}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(De,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},32:function(e,t,n){e.exports={InstrumentItem:"InstrumentItem_InstrumentItem__2cbPO",editBtnSpan:"InstrumentItem_editBtnSpan__B40fh",instrumentItemEditBtn:"InstrumentItem_instrumentItemEditBtn__2AXzm",instrumentItemUser:"InstrumentItem_instrumentItemUser__2QpPn",instrumentItemCom:"InstrumentItem_instrumentItemCom__c18pS",itemIcon:"InstrumentItem_itemIcon__2YJRS",itemCom:"InstrumentItem_itemCom__13H1z",instrumentItemComTextArea:"InstrumentItem_instrumentItemComTextArea__33FEY"}},39:function(e,t,n){e.exports={TakeDropItem:"TakeDropItem_TakeDropItem__2j6eD",editBtnSpan:"TakeDropItem_editBtnSpan__1MQ2G",instrumentItemEditBtn:"TakeDropItem_instrumentItemEditBtn__3RzdF",instrumentItemUser:"TakeDropItem_instrumentItemUser__Yn5ZP",instrumentItemCom:"TakeDropItem_instrumentItemCom__bYkLL",itemIcon:"TakeDropItem_itemIcon__36a3t",itemCom:"TakeDropItem_itemCom__D8ShH",instrumentItemComTextArea:"TakeDropItem_instrumentItemComTextArea__1pFuC"}},51:function(e,t,n){e.exports={Drop:"Drop_Drop__38ahr",header:"Drop_header__3QfQt",upList:"Drop_upList__2HvNk",filters:"Drop_filters__Ngn7y",intrumentList:"Drop_intrumentList__255ZN"}},62:function(e,t,n){e.exports={Login:"Login_Login__2_0l5",loginForm:"Login_loginForm__12tp8",loginInput:"Login_loginInput__1rMHE"}},63:function(e,t,n){e.exports={Users:"Users_Users__3IplX",header:"Users_header__3BrKR",upList:"Users_upList__3tgk7",filters:"Users_filters__1v8Zi",userList:"Users_userList__gKf8_"}},64:function(e,t,n){e.exports={Instruments:"Instruments_Instruments__rkjBf",header:"Instruments_header__2S7gc",upList:"Instruments_upList__ZjF7f",filters:"Instruments_filters__156X1",intrumentList:"Instruments_intrumentList__2Rcbd"}},71:function(e,t,n){e.exports={UserItem:"UserItem_UserItem__3xO8t",editBtnSpan:"UserItem_editBtnSpan__3w0j0",userItemEditBtn:"UserItem_userItemEditBtn__2eE1i",userItemInfo:"UserItem_userItemInfo__EHIq1",userItemCom:"UserItem_userItemCom__2oKMg",itemIcon:"UserItem_itemIcon__1yMEG",itemCom:"UserItem_itemCom__28FFm",userItemComTextArea:"UserItem_userItemComTextArea__1lJCs"}}},[[133,1,2]]]);
//# sourceMappingURL=main.b258bfed.chunk.js.map
